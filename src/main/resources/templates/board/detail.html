<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
	<header th:replace="~{fragments/base :: head}"></header>
	<style>
		td, th { text-align: center; }
		body {
        font-family: 'Arial', sans-serif; /* 폰트 변경 */
        background-color: #f9f9f9; /* 배경색 변경 */
    }
    .container {
        max-width: 1200px; /* 최대 너비 설정 */
        margin: 0 auto; /* 중앙 정렬 */
        background-color: #fff; /* 컨테이너 배경색 */
        padding: 20px; /* 패딩 */
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* 그림자 효과 */
    }
    a, a:hover {
        color: #007bff; /* 링크 색상 변경 */
        text-decoration: none; /* 밑줄 제거 */
    }
    .btn {
        display: inline-block;
        background-color: #007bff; /* 버튼 배경색 */
        color: white; /* 버튼 텍스트 색상 */
        padding: 10px 15px; /* 버튼 패딩 */
        border-radius: 5px; /* 둥근 모서리 */
        cursor: pointer; /* 마우스 오버 시 커서 변경 */
    }
    .btn:hover {
        background-color: #0056b3; /* 호버 시 배경색 변경 */
    }
		
	</style>
	<script th:inline="javascript">
		function likeClick(bid) {
			$.ajax({
				type: 'GET',
				url: '/food/board/like/' + bid,
				success: function(count) {
					$('#likeCount').replaceWith(count);
				}
			});
		}
		function deleteBoard() {
			$('#deleteModal').modal('show');
		}
	</script>
</head>
<body>
	<div th:insert="~{fragments/base :: top}"></div>

	<div class="container" style="margin-top:80px">
		<div class="row">
			<div class="col-3">
				<aside th:replace="~{fragments/base :: aside}"></aside>
			</div>

			<div class="col-9">
				<main id="main">
					<h3><strong>맛집 소개</strong>
						<span style="font-size:16px">
							<a th:href="@{/board/list(p=${currentBoardPage},f=${field},q=${query})}"><i class="fa-solid fa-table-list ms-5"></i> 목록</a>
							<span th:if="${session.sessUid eq board.uid}">	<!-- 본인만 수정/삭제 가능 -->
								<a th:href="@{/board/update/{x}(x=${board.bid})}"><i class="fa-solid fa-file-pen ms-3"></i> 수정</a>
								<a href="javascript:void" onclick="deleteBoard()"><i class="fa-solid fa-trash ms-3"></i> 삭제</a>
							</span>
							<span th:if="${session.sessUid ne board.uid}">	
								<a href="#" class="disabled-link"><i class="fa-solid fa-file-pen ms-3"></i> 수정</a>
								<a href="#" class="disabled-link"><i class="fa-solid fa-trash ms-3"></i> 삭제</a>
							</span>
						</span>
					</h3>
					<hr>
					<div class="row mb-3">
						<div class="col-8">
							<h5>[[${board.title}]]</h5>
							<h6>글번호: [[${board.bid}]] &nbsp;&nbsp; 
								<span th:text="${#temporals.format(board.modTime, 'yyyy-MM-dd HH:mm:ss')}"></span></h6>
							<h6>카테고리:
								<span th:each="file: ${fileList}">
									<a th:href="@{/file/download/upload/{x}(x=${file})}" class="me-2" download>[[${file}]]</a>
								</span>
							</h6>
						</div>
						<div class="col-4 text-end">
							<h5>[[${board.uname}]]</h5>
							<h6>조회 [[${board.viewCount}]] &nbsp;&nbsp; 댓글 [[${board.replyCount}]]</h6>
							<h6>
								<span th:if="${session.sessUid eq board.uid}">	<!-- 본인은 좋아요 누르지 못함 -->
									<a href="#">
										<span th:if="${session.likeClicked == 1}"><i class="fa-solid fa-thumbs-up"></i></span>
										<span th:if="${session.likeClicked == 0}"><i class="fa-regular fa-thumbs-up"></i> </span>
										[[${count}]]
									</a>
								</span>
								<span th:if="${session.sessUid ne board.uid}">
									<a href="#" th:onclick="likeClick([[${board.bid}]])">
										<span th:if="${session.likeClicked == 1}"><i class="fa-solid fa-thumbs-up"></i></span>
										<span th:if="${session.likeClicked == 0}"><i class="fa-regular fa-thumbs-up"></i> </span>
										<span id="likeCount" th:text="${count}"></span>
									</a>
								</span>
							</h6>
						</div>
						<hr>
						1. 가게 번호<br>
						2. 가게 영업 시간 - 종료 시간<br>
						3. 가게 주소
						<div class="col-12" th:utext="${board.content}"></div>
						<br><br><hr>	
						3rd hr						
					</div>

					<div th:each="reply: ${replyList}">
						<div class="row" th:if="${reply.isMine == 0}">
							<div class="col-9">
								<span class="me-2">[[${reply.uname}]] 사진 1</span>
								<span th:text="${#temporals.format(reply.regTime, 'yyyy-MM-dd HH:mm:ss')}"></span><br>
								<span>[(${reply.comment})] 사진 2</span>
							</div>
							<div class="col-3"></div>
						</div>
						<div class="row" th:if="${reply.isMine == 1}">
							<div class="col-3"></div>
							<div class="col-9 text-end">
								<span class="me-2">[[${reply.uname}]] 사진3</span>
								<span th:text="${#temporals.format(reply.regTime, 'yyyy-MM-dd HH:mm:ss')}"></span><br>
								<span>[(${reply.comment})] 지도/위치</span>
							</div>
						</div>
						<hr>
					</div>
					<form class="form-inline" action="/food/board/reply" method="post">
						<input type="hidden" name="bid" th:value="${board.bid}">
						<input type="hidden" name="uid" th:value="${board.uid}">
						<div class="row d-flex mt-2" style="align-items: center;">
							<div class="col-1">
								<label class="col-form-label">댓글</label>
							</div>
							<div class="col-9">
								<textarea name="comment" rows="2" class="form-control"></textarea>
							</div>
							<div class="col-2">
								<button type="submit" class="btn btn-primary ms-3">등록</button>
							</div>
						</div>
					</form>
				</main>
			</div>
		</div>
	</div>

	<footer th:replace="~{fragments/base :: bottom}"></footer>

	<div class="modal" id="deleteModal">
		<div class="modal-dialog">
			<div class="modal-content">
				<!-- Modal Header -->
				<div class="modal-header">
					<h4 class="modal-title">게시글 삭제</h4>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
			
				<!-- Modal body -->
				<div class="modal-body">
					<strong>정말로 삭제하시겠습니까?</strong>
					<div class="text-center mt-5">
						<button type="button" class="btn btn-danger" th:onclick="|location.href='@{/board/delete/{x}(x=${board.bid})}'|">삭제</button>
						<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">취소</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>